<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/dagger/blog/rss.xml" title="Dagger Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dagger/blog/atom.xml" title="Dagger Blog Atom Feed"><title data-react-helmet="true">Development Guide | Dagger</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://odpf.github.io//dagger/docs/contribute/development"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Development Guide | Dagger"><meta data-react-helmet="true" name="description" content="The following segment is a foundation for developing things on top of Dagger."><meta data-react-helmet="true" property="og:description" content="The following segment is a foundation for developing things on top of Dagger."><link data-react-helmet="true" rel="shortcut icon" href="/dagger/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://odpf.github.io//dagger/docs/contribute/development"><link data-react-helmet="true" rel="alternate" href="https://odpf.github.io//dagger/docs/contribute/development" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://odpf.github.io//dagger/docs/contribute/development" hreflang="x-default"><link rel="stylesheet" href="/dagger/assets/css/styles.b52f1d85.css">
<link rel="preload" href="/dagger/assets/js/runtime~main.d9601046.js" as="script">
<link rel="preload" href="/dagger/assets/js/main.60c15db9.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dagger/"><img src="/dagger/img/logo-n.svg" alt="Dagger" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/dagger/img/logo-n.svg" alt="Dagger" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Dagger</b></a><a class="navbar__item navbar__link navbar__link--active" href="/dagger/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/dagger/blog">Blog</a><a class="navbar__item navbar__link" href="/dagger/help">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/odpf/dagger" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-github"></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">☾</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">☀️</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/dagger/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/dagger/docs/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advance</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Usecases</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Contribute</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/contribute/contribution">Contribution Process</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dagger/docs/contribute/development">Development Guide</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/contribute/add_transformer">ADD Transformer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/contribute/add_udf">ADD UDF</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Development Guide</h1></header><p>The following segment is a foundation for developing things on top of Dagger.</p><p>The main logical blocks of Dagger are:</p><ul><li><code>Streams</code>: All Kafka source related information for Data consumption.</li><li><code>SQL</code>: SQL Query to process input stream data.</li><li><code>Processors</code>: Plugins to define custom Operators and to interact with external data sources.</li><li><code>Sink</code>: Sinking data after processing is done.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="run-a-dagger"></a>Run a Dagger<a class="hash-link" href="#run-a-dagger" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="development-environment"></a>Development environment<a class="hash-link" href="#development-environment" title="Direct link to heading">#</a></h3><p>The following environment is required for Dagger development</p><ul><li>Java SE Development Kit 8.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="services"></a>Services<a class="hash-link" href="#services" title="Direct link to heading">#</a></h3><p>The following components/services are required to run Dagger:</p><ul><li>Kafka &gt; 2.4 to consume messages from.</li><li>Corresponding sink service to sink data to.</li><li>Flink Cluster (Optional) only needed if you want to run in cluster mode. For standalone mode, it&#x27;s not required.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="local-creation"></a>Local Creation<a class="hash-link" href="#local-creation" title="Direct link to heading">#</a></h3><p>Follow <a href="/dagger/docs/guides/create_dagger">dagger creation guide</a> for creating/configuring a Dagger in the local environment and to know more about the basic stages of Dagger.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="style-guide"></a>Style Guide<a class="hash-link" href="#style-guide" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="java"></a>Java<a class="hash-link" href="#java" title="Direct link to heading">#</a></h3><p>We conform to the <a href="https://google.github.io/styleguide/javaguide.html" target="_blank" rel="noopener noreferrer">Google Java Style Guide</a>. Maven can helpfully take care of that for you before you commit.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="code-modules"></a>Code Modules<a class="hash-link" href="#code-modules" title="Direct link to heading">#</a></h2><p>Dagger follows a multi-project build structure with multiple sub-projects. This allows us to maintain the code base logically segregated and remove the duplications. Describing briefly each submodule.</p><ul><li><strong><code>dagger-core</code></strong>: The core module in Dagger. Accommodates All the core functionalities like SerDE, SQL execution, Processors and many more. Also efficiently interacts with other subprojects.</li><li><strong><code>dagger-common</code></strong>: This module contains all the code/contracts that are shared between other submodules. This allows reducing code duplicate and an efficient sharing of code between other submodules. For example, MetricsManagers are part of this submodule since metrics need to be recorded both in <code>dagger-common</code> and <code>dagger-functions</code>.</li><li><strong><code>dagger-functions</code></strong>: Submodule that defines all the plugin components in Dagger like <a href="https://github.com/odpf/dagger/tree/main/dagger-functions/src/main/java/io/odpf/dagger/functions/udfs" target="_blank" rel="noopener noreferrer">UDFs</a> and <a href="https://github.com/odpf/dagger/tree/main/dagger-functions/src/main/java/io/odpf/dagger/functions/transformers" target="_blank" rel="noopener noreferrer">Transformers</a>.</li><li><strong><code>dagger-tests</code></strong>: Integration test framework to test some central end to end flows in Dagger.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="dependencies-configuration"></a>Dependencies Configuration<a class="hash-link" href="#dependencies-configuration" title="Direct link to heading">#</a></h2><ul><li>Dagger generates three different types of jars. One traditional fat/shadow.jar with all the dagger specific code + the external dependencies, that is sufficient for running a dagger. Since this jar becomes heavyweight (~200MB) and takes few seconds to get uploaded to the cluster, Dagger provides another setup for jar creation where we segregate the dependencies from the Dagger code base.</li><li>The external dependencies in Dagger are less frequently updated. So we treat them as static and update on a major release.</li><li>The more frequently changing Dagger codebase reside in the minimal jar whose size is in KBs and gets uploaded to the cluster in a flash. The deployment section talks more about jar creation and how to deploy them to the Flink cluster.</li><li>The jar separation is a part of Gradle configuration. We define two new sets of configurations in all of the Dagger submodules.<ul><li><code>minimalJar</code>: add all dependencies to be included in the Dagger cluster user jar.</li><li><code>dependenciesJar</code>: add all dependencies to be included in the flink image.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="integration-tests"></a>Integration Tests<a class="hash-link" href="#integration-tests" title="Direct link to heading">#</a></h2><p>Dagger interacts with external sources such as ElasticSearch, Postgres and HTTP endpoints to enrich the streams using post-processors. We have added Integration Tests to expose and resolve blunders in the interaction between integrated units at the time of development itself.</p><p>Integration Tests are part of the current CI set-up of Dagger and they must pass before releasing a version of Dagger. These will cover all the flows of postprocessors with different external sources and ensure a bug-free dagger.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="dev-setup-for-local-integration-tests"></a>Dev Setup for Local Integration Tests<a class="hash-link" href="#dev-setup-for-local-integration-tests" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="setup-elasticsearch"></a>Setup Elasticsearch<a class="hash-link" href="#setup-elasticsearch" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># install elastic search</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">brew update</span></span><span class="token-line" style="color:#393A34"><span class="token plain">brew install elasticsearch</span></span><span class="token-line" style="color:#393A34"><span class="token plain">brew services start elasticsearch</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="setup-postgres"></a>Setup Postgres<a class="hash-link" href="#setup-postgres" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># install postgres in local environment</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">brew update</span></span><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> postgresql</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#configure postgres for integration tests</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">psql postgres</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> create user root with password root</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> create ROLE root WITH LOGIN PASSWORD </span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token plain"> CREATEDB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Login Via root now and create test database</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> psql postgres -U root</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">postgres</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">create database test_db</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="run-integration-tests"></a>Run Integration tests<a class="hash-link" href="#run-integration-tests" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./gradlew clean IntegrationTest</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/odpf/dagger/edit/master/docs/docs/contribute/development.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dagger/docs/contribute/contribution"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Contribution Process</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dagger/docs/contribute/add_transformer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ADD Transformer »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#run-a-dagger" class="table-of-contents__link">Run a Dagger</a><ul><li><a href="#development-environment" class="table-of-contents__link">Development environment</a></li><li><a href="#services" class="table-of-contents__link">Services</a></li><li><a href="#local-creation" class="table-of-contents__link">Local Creation</a></li></ul></li><li><a href="#style-guide" class="table-of-contents__link">Style Guide</a><ul><li><a href="#java" class="table-of-contents__link">Java</a></li></ul></li><li><a href="#code-modules" class="table-of-contents__link">Code Modules</a></li><li><a href="#dependencies-configuration" class="table-of-contents__link">Dependencies Configuration</a></li><li><a href="#integration-tests" class="table-of-contents__link">Integration Tests</a><ul><li><a href="#dev-setup-for-local-integration-tests" class="table-of-contents__link">Dev Setup for Local Integration Tests</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/odpf/optimus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Optimus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/firehose" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Firehose<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/raccoon" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Raccoon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/stencil" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stencil<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dagger/docs/intro">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/dagger/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/dagger/help">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://bit.ly/2RzPbtn" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/dagger" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/dagger/assets/js/runtime~main.d9601046.js"></script>
<script src="/dagger/assets/js/main.60c15db9.js"></script>
</body>
</html>