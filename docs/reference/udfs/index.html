<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/dagger/blog/rss.xml" title="Dagger Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dagger/blog/atom.xml" title="Dagger Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KDHSNBDXW8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KDHSNBDXW8",{})</script><title data-react-helmet="true">Udfs | Dagger</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://odpf.github.io//dagger/docs/reference/udfs"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Udfs | Dagger"><meta data-react-helmet="true" name="description" content="This page contains references for all the custom udfs available on Dagger."><meta data-react-helmet="true" property="og:description" content="This page contains references for all the custom udfs available on Dagger."><link data-react-helmet="true" rel="shortcut icon" href="/dagger/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://odpf.github.io//dagger/docs/reference/udfs"><link data-react-helmet="true" rel="alternate" href="https://odpf.github.io//dagger/docs/reference/udfs" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://odpf.github.io//dagger/docs/reference/udfs" hreflang="x-default"><link rel="stylesheet" href="/dagger/assets/css/styles.810909c7.css">
<link rel="preload" href="/dagger/assets/js/runtime~main.bebf1512.js" as="script">
<link rel="preload" href="/dagger/assets/js/main.f47a97c9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#222;color:#eee" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">⭐️ If you like Dagger, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/odpf/dagger">GitHub</a>! ⭐</div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dagger/"><img src="/dagger/img/logo-n.svg" alt="Dagger" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/dagger/img/logo-n.svg" alt="Dagger" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Dagger</b></a><a class="navbar__item navbar__link navbar__link--active" href="/dagger/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/dagger/blog">Blog</a><a class="navbar__item navbar__link" href="/dagger/help">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://bit.ly/2RzPbtn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link"></a><a href="https://github.com/odpf/dagger" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-github"></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">☾</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">☀️</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/dagger/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/dagger/docs/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advance</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Usecases</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Reference</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/reference/overview">Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/reference/configuration">Configurations</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/reference/metrics">Metrics</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/dagger/docs/reference/transformers">Transformers</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dagger/docs/reference/udfs">Udfs</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contribute</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Udfs</h1></header><p>This page contains references for all the custom udfs available on Dagger.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="list-of-udfs"></a>List of Udfs<a class="hash-link" href="#list-of-udfs" title="Direct link to heading">#</a></h2><ul><li><a href="/dagger/docs/reference/udfs#scalar-functions">Scalar Functions</a><ul><li><a href="/dagger/docs/reference/udfs#ArrayAggregate">ArrayAggregate</a></li><li><a href="/dagger/docs/reference/udfs#ArrayOperate">ArrayOperate</a></li><li><a href="/dagger/docs/reference/udfs#CondEq">CondEq</a></li><li><a href="/dagger/docs/reference/udfs#DartContains">DartContains</a></li><li><a href="/dagger/docs/reference/udfs#DartGet">DartGet</a></li><li><a href="/dagger/docs/reference/udfs#Distance">Distance</a></li><li><a href="/dagger/docs/reference/udfs#ElementAt">ElementAt</a></li><li><a href="/dagger/docs/reference/udfs#EndOfMonth">EndOfMonth</a></li><li><a href="/dagger/docs/reference/udfs#EndOfWeek">EndOfWeek</a></li><li><a href="/dagger/docs/reference/udfs#ExponentialMovingAverage">ExponentialMovingAverage</a></li><li><a href="/dagger/docs/reference/udfs#Filters">Filters</a></li><li><a href="/dagger/docs/reference/udfs#FormatTimeInZone">FormatTimeInZone</a></li><li><a href="/dagger/docs/reference/udfs#GeoHash">GeoHash</a></li><li><a href="/dagger/docs/reference/udfs#LinearTrend">LinearTrend</a></li><li><a href="/dagger/docs/reference/udfs#ListContains">ListContains</a></li><li><a href="/dagger/docs/reference/udfs#MapGet">MapGet</a></li><li><a href="/dagger/docs/reference/udfs#S2AreaInKm2">S2AreaInKm2</a></li><li><a href="/dagger/docs/reference/udfs#S2Id">S2Id</a></li><li><a href="/dagger/docs/reference/udfs#SelectFields">SelectFields</a></li><li><a href="/dagger/docs/reference/udfs#SingleFeatureWithType">SingleFeatureWithType</a></li><li><a href="/dagger/docs/reference/udfs#Split">Split</a></li><li><a href="/dagger/docs/reference/udfs#StartOfMonth">StartOfMonth</a></li><li><a href="/dagger/docs/reference/udfs#StartOfWeek">StartOfWeek</a></li><li><a href="/dagger/docs/reference/udfs#TimeInDate">TimeInDate</a></li><li><a href="/dagger/docs/reference/udfs#TimestampFromUnix">TimestampFromUnix</a></li></ul></li><li><a href="/dagger/docs/reference/udfs#aggregate-functions">Aggregate Functions</a><ul><li><a href="/dagger/docs/reference/udfs#CollectArray">CollectArray</a></li><li><a href="/dagger/docs/reference/udfs#DistinctCount">DistinctCount</a></li><li><a href="/dagger/docs/reference/udfs#Features">Features</a></li><li><a href="/dagger/docs/reference/udfs#FeaturesWithType">FeaturesWithType</a></li><li><a href="/dagger/docs/reference/udfs#PercentileAggregator">PercentileAggregator</a></li></ul></li><li><a href="/dagger/docs/reference/udfs#table-functions">Table Functions</a><ul><li><a href="/dagger/docs/reference/udfs#HistogramBucket">HistogramBucket</a></li><li><a href="/dagger/docs/reference/udfs#OutlierMad">OutlierMad</a></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="scalar-functions"></a>Scalar Functions<a class="hash-link" href="#scalar-functions" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="arrayaggregate"></a>ArrayAggregate<a class="hash-link" href="#arrayaggregate" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Object</strong> <code>ArrayAggregate(Object[] arrayElements, String operationType, String inputDataType)</code>.</li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>LongbowPlus</strong> but also can be used alone. Given an Object Array, this UDF performs basic Mathematical functions on the Array. You need to give the name of the function you want to use as a string and the Data type of the element inside the input array. Find details on LongbowPlus <a href="/dagger/docs/advance/longbow_plus">here</a>.</li><li>Currently, we only support limited operations on limited data types. The supported Data types and functions are listed below.</li></ul></li><li>Supported Data types and Functions:<ul><li>Data type:<ul><li>Integer</li><li>Float</li><li>Double</li><li>Long</li><li>Other(all other data types except the above)</li></ul></li><li>Functions:<ul><li>Basic Mathematical aggregation functions like ‘average’, ‘sum’, ‘min’, ’max’, ’count’, ’findFirst’ etc.</li><li>Do some basic complex aggregations like distinct counts. You need to give an argument like ‘distinct.count’ as operationType.Prefixes have to be added before actual functions with a ‘.’ whenever required. The first operation here needs to output another Array. So for now, ‘sort’ and ‘distinct’ are only supported as the first element in complex types.</li><li>In the case of Float, the output will be in double. </li><li>For ‘Other’ data types some basic operations like ‘count’, ‘findFirst’ are supported. You can also do something like ‘distinct.count’/’sort.findFirst’ here, but no other mathematical functions are supported here.</li><li>Listing here all the available functions for corresponding data types<ul><li>Mathematical Data Types:
&#x27;average&#x27;, &#x27;min&#x27;, &#x27;max&#x27;, &#x27;sum&#x27;, &#x27;count&#x27;, &#x27;findFirst&#x27;, &#x27;findAny&#x27;</li><li>Prefix:
&#x27;sort&#x27;, &#x27;distinct&#x27;</li><li>Other Data Types:
&#x27;count&#x27;, &#x27;findFirst&#x27;, &#x27;findAny&#x27;</li></ul></li></ul></li></ul></li><li>Example:<ul><li>When used a single aggregation<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ArrayAggregate(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(proto_data, input_class_name, &#x27;shopping_price&#x27;),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;sum&#x27;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;float&#x27;) AS total_shoping_price_value</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>When used a basic double aggregation<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ArrayAggregate(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(proto_data, input_class_name, &#x27;shopping_price&#x27;),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;distinct.sum&#x27;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;float&#x27;) AS average_value</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="arrayoperate"></a>ArrayOperate<a class="hash-link" href="#arrayoperate" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Object[]</strong> <code>ArrayOperate(Object[] arrayElements, String operationType, String inputDataType)</code></li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>LongbowPlus</strong> but also can be used alone. Given an Object Array, this UDF performs basic Mathematical functions on the Array. You need to give the name of the function you want to use as a string and the Data type of the element inside the input array. Find details on LongbowPlus <a href="/dagger/docs/advance/longbow_plus">here</a>.</li><li>Currently, we only support limited operations on limited data types. The supported Data types and functions are listed below.</li></ul></li><li>Supported Data types and Functions:<ul><li>Data type:<ul><li>Integer</li><li>Float</li><li>Double</li><li>Long</li><li>Other(all other data types except the above. For String you need to process it as Other)</li></ul></li><li>Functions:<ul><li>Distinct</li><li>Sorted</li></ul></li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ArrayOperate(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(proto_data, input_class_name, &#x27;shopping_price&#x27;),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;distinct&#x27;, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;float&#x27;) AS distinct_shoping_price_values</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="bytetostring"></a>ByteToString<a class="hash-link" href="#bytetostring" title="Direct link to heading">#</a></h4><ul><li>Contract:<ul><li><strong>String</strong> <code>ByteToString(ByteString byteField)</code></li></ul></li><li>Functionality:<ul><li>Given a ByteString, this UDF converts to String</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Select</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ByteToString(payload) as payload_string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">from</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_streams</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="condeq"></a>CondEq<a class="hash-link" href="#condeq" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><code>Predicate&lt;DynamicMessage&gt;** CondEq(String fieldName, Object comparison)</code></li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>LongbowPlus</strong> and has to be used with <strong>SelectFields</strong> and <strong>Filters</strong> UDFs. Find details on LongbowPlus <a href="/dagger/docs/advance/longbow_plus">here</a>.</li><li>Can specify an equality condition with a fieldName and a value.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    proto_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    input_class_name,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;order_number&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS favourite_service_provider_guids</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cardinality(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      Filters(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proto_data, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        input_class_name, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        CondEq(&#x27;status&#x27;, &#x27;CUSTOMER_CANCELLED&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;order_number&#x27; </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) &gt; 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dartcontains"></a>DartContains<a class="hash-link" href="#dartcontains" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Boolean</strong> <code>DartContains(String collectionName, String value, int cacheTTLin_hours)</code> OR</li><li><strong>Boolean</strong> <code>DartContains(String collectionName, String value, String regex, int cacheTTLin_hours)</code></li></ul></li><li>Functionality:<ul><li>Check if a data point in the message is present in the GCS bucket</li><li>Regex can you used to create the pattern using values from GCS to match against the field value.</li></ul></li><li>Example<ul><li>Without regex</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;1&#x27; HOUR) AS event_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  DartContains(&#x27;test_collection&#x27;, data1, 24)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;1&#x27; HOUR)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>With regex </li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;1&#x27; HOUR) AS event_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  DartContains(&#x27;test_collection&#x27;, data1, &#x27;^%s.*&#x27; 24)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;1&#x27; HOUR)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dartget"></a>DartGet<a class="hash-link" href="#dartget" title="Direct link to heading">#</a></h4><ul><li>Contract:<ul><li><strong>String</strong> <code>DartGet(String collectionName, key, int cacheTTLin_hour)</code></li></ul></li><li>Functionality: <ul><li>Corresponding value in a GCS bucket given a key from data point</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  DartGet(&#x27;test_collection&#x27;, data1, 24) AS tag_data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="distance"></a>Distance<a class="hash-link" href="#distance" title="Direct link to heading">#</a></h4><ul><li>Contract:<ul><li><strong>Double</strong> <code>Distance(Double latitude1, Double longitude1, Double latitude2, Double longitude2)</code></li></ul></li><li>Functionality: <ul><li>Calculates the distance between two points in km with given latitude and longitude.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Distance(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1_location.latitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1_location.longitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data2_location.latitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data2_location.longitude</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS distance_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">where</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  status = &#x27;CUSTOMER_CANCELLED&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1_location.latitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1_location.longitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data2_location.latitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data2_location.longitude</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="elementat"></a>ElementAt<a class="hash-link" href="#elementat" title="Direct link to heading">#</a></h4><ul><li>Contract:<ul><li><strong>String</strong> <code>ElementAt(Row[] array, String pathOfArray, int index, String path, String tableName)</code></li><li><strong>String</strong> <code>ElementAt(Row[] array, String pathOfArray, int index, String path)</code></li><li><strong>Object</strong> <code>ElementAt(Object[] array, int index)</code></li><li><strong>Object</strong> <code>ElementAt(ArrayList\&lt;Object\&gt; arrayList, int index)</code></li></ul></li><li>Functionality: <ul><li>For the given table name from the streams (In the case of multi-streams/JOINS), find out the element at a given index and a given path in an array of complex Data Types.</li><li>Finds out the element at a given index and a given path in an array of complex Data Types. Here table name is not provided, In that case, it will always apply the function on the table from the first stream in the configuration.</li><li>Finds out the element at a given index in case of an object Array.</li><li>Finds out the element at a given index in case of an object Arraylist.</li></ul></li><li>Examples:<ul><li>Example 1:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.latitude&#x27;, &#x27;data_stream_2&#x27;) AS double</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS lat,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.longitude&#x27;, &#x27;data_stream_2&#x27;) AS double</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS long,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream_1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.latitude&#x27;, &#x27;data_stream_2&#x27;),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.longitude&#x27;, &#x27;data_stream_2&#x27;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>Example 2:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.latitude&#x27;) AS double</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS lat,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.longitude&#x27;) AS double</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS long,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.latitude&#x27;),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data, &#x27;data&#x27;, 0, &#x27;test_location.longitude&#x27;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>Example 3:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">WITH tmpTable AS (</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    proto_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    input_class_name,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;cancel_reason_id&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS test_data_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  longbow_read_key AS restaurant_id</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  restaurant_id,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data_array, -1) AS last_test_data_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data_array, -2) AS second_last_test_data_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ElementAt(test_data_array, -3) AS third_last_test_data_array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  tmpTable</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="endofmonth"></a>EndOfMonth<a class="hash-link" href="#endofmonth" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Long</strong> <code>EndOfMonth(long seconds, String timeZone)</code></li></ul></li><li>Functionality:<ul><li>Calculates the seconds in Unix time for the end of a month of a given timestamp second and timezone.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  EndOfMonth(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_timestamp.seconds, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;America/New_York&#x27;) AS T</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="endofweek"></a>EndOfWeek<a class="hash-link" href="#endofweek" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Long</strong> <code>EndOfWeek(long seconds, String timeZone)</code></li></ul></li><li>Functionality:<ul><li>Calculates the seconds in Unix time for the end of a week of a given timestamp second and timezone.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  EndOfWeek(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_timestamp.seconds,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;America/New_York&#x27;) AS T</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="exponentialmovingaverage"></a>ExponentialMovingAverage<a class="hash-link" href="#exponentialmovingaverage" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Double</strong> <code>ExponentialMovingAverage(ArrayList\&lt;Timestamp\&gt; timestampsArray, ArrayList\&lt;Double\&gt; valuesArray, Timestamp hopStartTime, Double window, Double alpha)</code></li></ul></li><li>Functionality:<ul><li>Calculates exponential moving average (at per minute frequency) using a list of non-null values. Parameters are window (in minutes) and alpha. The hopStartTime and the corresponding list of timestamps denote the sequence of the non-null values in the window.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ExponentialMovingAverage(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      timestamps_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      values_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      hop_start_time,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      CAST(15 AS DOUBLE),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      CAST(0.2 AS DOUBLE)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) AS BIGINT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS unique_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  event_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="filters"></a>Filters<a class="hash-link" href="#filters" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><code>List&lt;DynamicMessage&gt;** Filters(ByteString[] inputProtoBytes, String protoClassName, Predicate&lt;DynamicMessage&gt;... predicates)</code></li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>LongbowPlus</strong> and has to be used with <strong>SelectFields</strong> and <strong>CondEq</strong> UDFs. Find details on LongbowPlus <a href="/dagger/docs/advance/longbow_plus">here</a>.</li><li>Takes ByteString[] as the data and zero or more Predicates (we have only CondEq as a predicate that is defined for now). Applies the predicated conditions on the proto ByteString list field that is selected from the query and returns filtered Data.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    proto_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    input_class_name,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;order_number&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS favourite_service_provider_guids</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cardinality(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      Filters(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proto_data, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        input_class_name, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        CondEq(&#x27;status&#x27;, &#x27;CUSTOMER_CANCELLED&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;order_number&#x27; </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) &gt; 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="formattimeinzone"></a>FormatTimeInZone<a class="hash-link" href="#formattimeinzone" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>String</strong> <code>FormatTimeInZone(Timestamp timestamp, String timeZone, String dateFormat)</code></li></ul></li><li>Functionality:<ul><li>Gets formatted time from timestamp in given timezone.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  FormatTimeInZone(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_timestamp,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;America/New_York&#x27;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;yyyy-MM-dd&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS T</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="geohash"></a>GeoHash<a class="hash-link" href="#geohash" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>GeoHash</strong><code>(Double latitude, Double longitude, int level)</code></li></ul></li><li>Functionality:<ul><li>Returns a geohash for a given level and lat-long for the given WGS84 point.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1_location.longitude AS long,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1_location.latitude AS lat,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  GeoHash(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1_location.longitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1_location.latitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    6</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS geohashPickup,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1_location.longitude,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1_location.latitude</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="lineartrend"></a>LinearTrend<a class="hash-link" href="#lineartrend" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Double</strong> <code>LinearTrend(ArrayList&lt;Timestamp&gt; timestampsArray, ArrayList&lt;Double&gt; demandList, Timestamp hopStartTime, Integer windowLengthInMinutes)</code></li></ul></li><li>Functionality:<ul><li>Returns the gradient of the best fit line of the list of non-null demand values given the defined time window. hopStartTime and timestampsArray denote the sequence of non-null demand values in the window.</li><li>Find more details on Linear Trend Algorithm <a href="https://en.wikipedia.org/wiki/Linear_trend_estimation" target="_blank" rel="noopener noreferrer">here</a>.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    LinearTrend(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      timestamps_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      values_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      hop_start_time,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      15</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) AS BIGINT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS unique_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  event_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="listcontains"></a>ListContains<a class="hash-link" href="#listcontains" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Boolean</strong> <code>ListContains(String[] inputList, String item)</code></li></ul></li><li>Functionality:<ul><li>Checks if a list contains a given item.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ListContains(tests, &#x27;test1&#x27;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="mapget"></a>MapGet<a class="hash-link" href="#mapget" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Object</strong> <code>MapGet(Row[] inputMap, Object key)</code></li></ul></li><li>Functionality:<ul><li>Returns value for a corresponding key inside a map data type.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAST(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MapGet(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      metadata,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;data1&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ) AS VARCHAR</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) AS data1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="s2areainkm2"></a>S2AreaInKm2<a class="hash-link" href="#s2areainkm2" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Boolean</strong> <code>S2AreaInKm2(String s2id)</code></li></ul></li><li>Functionality:<ul><li>Computes the area of an s2 cell in km2</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  s2_id,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  S2AreaInKm2(s2_id) AS area,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  event_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="selectfields"></a>SelectFields<a class="hash-link" href="#selectfields" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Object[]</strong> <code>SelectFields(ByteString[] inputProtoBytes, String protoClassName, String fieldPath) , Object[] SelectFields(List&lt;DynamicMessage&gt; filteredData, String fieldPath)</code></li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>LongbowPlus</strong> and has to be used either with <strong>SelectFields</strong> and <strong>Filters</strong> UDFs or alone. Find details on LongbowPlus <a href="/dagger/docs/advance/longbow_plus">here</a>.</li><li>Can select a single field from the list of proto bytes output from the LongbowRead phase. Can be used with or without applying filters on top of LongbowRead output(which will be in repeated bytes).</li></ul></li><li>Example:<ul><li>When used alone:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cardinality(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      proto_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      input_class_name,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;order_number&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>When used with Filters<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    proto_data,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    input_class_name,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;order_number&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS favourite_service_provider_guids</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  cardinality(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectFields(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      Filters(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proto_data, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        input_class_name, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        CondEq(&#x27;status&#x27;, &#x27;CUSTOMER_CANCELLED&#x27;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;order_number&#x27; </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) &gt; 0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="s2id"></a>S2Id<a class="hash-link" href="#s2id" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>String</strong> <code>S2Id(Double latitude, Double longitude, int level)</code></li></ul></li><li>Functionality:<ul><li>Computes s2id for given lat, long and level.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  S2Id(data1.latitude, data1.longitude, 13) AS tag_s2id,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND),</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="singlefeaturewithtype"></a>SingleFeatureWithType<a class="hash-link" href="#singlefeaturewithtype" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Row[]</strong> <code>SingleFeatureWithType(Object... value)</code></li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>Feast</strong>. Find details on Feast <a href="https://github.com/feast-dev/feast/tree/master/docs#introduction" target="_blank" rel="noopener noreferrer">here</a>.</li><li>Converts the given list of objects to a FeatureRow type with key and values from the first two args from every triplet passed in args and data type according to the third element of the triplet.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SingleFeatureWithType(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;data1&#x27;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;StringType&#x27;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;data2&#x27;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;FloatType&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS features</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="split"></a>Split<a class="hash-link" href="#split" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>String[]</strong> <code>Split(String inputString, String delimiter)</code></li></ul></li><li>Functionality:<ul><li>Split input string based on input delimiter. The delimiter is a regex string, if you want to split by &quot;.&quot;, you should use &quot;\.&quot; or it will give an empty array.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  SPLIT(data1) as new_data1, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="startofmonth"></a>StartOfMonth<a class="hash-link" href="#startofmonth" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Long</strong> <code>StartOfMonth(long seconds, String time_zone)</code></li></ul></li><li>Functionality:<ul><li>Calculates the seconds in Unix time for the start of a month of a given timestamp second and timezone.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StartOfMonth(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_timestamp.seconds,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;America/New_York&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS start_of_month</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="startofweek"></a>StartOfWeek<a class="hash-link" href="#startofweek" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Long</strong> <code>StartOfWeek(long seconds, String timeZone)</code></li></ul></li><li>Functionality:<ul><li>Calculates the seconds in Unix time for the start of a week of a given timestamp second and timezone.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StartOfWeek(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_timestamp.seconds,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;America/New_York&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS start_of_week</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="timeindate"></a>TimeInDate<a class="hash-link" href="#timeindate" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Long</strong> <code>TimeInDate(long event_timestamp, int hour, int minute)</code></li><li><strong>Long</strong> <code>TimeInDate(long seconds, int hour, int minute, String time_zone)</code></li></ul></li><li>Functionality:<ul><li>Returns calender&#x27;s time value in seconds</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TimeInDate(event_timestamp.seconds, 10, 30, &#x27;America/New_York&#x27;) AS date</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="timestampfromunix"></a>TimestampFromUnix<a class="hash-link" href="#timestampfromunix" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Timestamp</strong> TimestampFromUnix(long seconds) </li></ul></li><li>Functionality:<ul><li>Gets java.sql.Timestamp from UNIX seconds.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TimestampFromUnix(event_timestamp.seconds) AS T</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="aggregate-functions"></a>Aggregate Functions<a class="hash-link" href="#aggregate-functions" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="collectarray"></a>CollectArray<a class="hash-link" href="#collectarray" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong><code>ArrayList&lt;Object&gt;</code></strong> <code>CollectArray(Object obj)</code></li></ul></li><li>Functionality:<ul><li>Return an ArrayList of the objects passed.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CollectArray(DISTINCT data1) AS data1s,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE(rowtime, INTERVAL &#x27;60&#x27; SECOND)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="distinctcount"></a>DistinctCount<a class="hash-link" href="#distinctcount" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Int</strong> <code>DistinctCount(String metric)</code></li></ul></li><li>Functionality:<ul><li>Returns the distinct count of a field in the input stream.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  DistinctCount(data1) AS distic_count_data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;60&#x27; SECOND) AS window_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;60&#x27; SECOND)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="features"></a>Features<a class="hash-link" href="#features" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong><code>Row[]</code></strong> <code>Features(Object... objects)</code></li></ul></li><li>Functionality:</li><li>This is one of the UDFs related to <strong>Feast</strong>. Find details on Feast <a href="https://github.com/feast-dev/feast/tree/master/docs#introduction" target="_blank" rel="noopener noreferrer">here</a>.<ul><li>Converts the given list of objects to a FeatureRow type with key and values from every pair passed in args.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Features(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS features,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE_END(rowtime, INTERVAL &#x27;1&#x27; MINUTE) AS event_timestamp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE (rowtime, INTERVAL &#x27;1&#x27; MINUTE)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="featureswithtype"></a>FeaturesWithType<a class="hash-link" href="#featureswithtype" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong><code>Row[]</code></strong> <code>FeaturesWithType(Object... value)  [for FeatureRow]</code></li></ul></li><li>Functionality:<ul><li>This is one of the UDFs related to <strong>Feast</strong>. Find details on Feast <a href="https://github.com/feast-dev/feast/tree/master/docs#introduction" target="_blank" rel="noopener noreferrer">here</a>.</li><li>Converts the given list of objects to a FeatureRow type with key and values from the first two args from every triplet passed in args and data type according to the third element of the triplet.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  FeaturesWithType(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;data1&#x27;, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;StringType&#x27;, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;data2&#x27;, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data2, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;FloatType&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS features,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE(rowtime, INTERVAL &#x27;1&#x27; MINUTE)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="percentileaggregator"></a>PercentileAggregator<a class="hash-link" href="#percentileaggregator" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Double</strong> <code>PercentileAggregator(BigDecimal percentile, BigDecimal value)</code></li></ul></li><li>Functionality:<ul><li>Get percentile value.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  PercentileAggregator(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data1, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) AS percentile,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TUMBLE(rowtime, INTERVAL &#x27;1&#x27; MINUTE)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="table-functions"></a>Table Functions<a class="hash-link" href="#table-functions" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="histogrambucket"></a>HistogramBucket<a class="hash-link" href="#histogrambucket" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Void</strong> <code>HistogramBucket(double dValue, String buckets)</code></li></ul></li><li>Functionality:<ul><li>Returns buckets for given value to calculate histograms.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data1, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data3,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;buckets&#x27;, </span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LATERAL TABLE(HistogramBucket(data1, &#x27;buckets&#x27;));</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="outliermad"></a>OutlierMad<a class="hash-link" href="#outliermad" title="Direct link to heading">#</a></h4><ul><li>Contract: <ul><li><strong>Void</strong> <code>OutlierMad(ArrayList&lt;Double&gt; values, ArrayList&lt;Timestamp&gt; timestampsArray, Timestamp windowStartTime, Integer windowLengthInMinutes, Integer observationPeriodInMinutes, Integer tolerance, Integer outlierPercentage)</code></li></ul></li><li>Functionality:<ul><li>Determines outliers for a given time series based on threshold, observation window, and tolerance provided.</li></ul></li><li>Example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `timestamp` AS window_timestamp,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `value`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `upperBound`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `lowerBound`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CASE</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHEN `isOutlier` THEN 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ElSE 0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  END as isOutlier</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM </span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LATERAL TABLE(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  OutlierMad(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    values_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    timestamps_array,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    hop_start_time,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(20 AS INTEGER),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(3 AS INTEGER),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(10 AS INTEGER),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(10 AS INTEGER)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">) AS T(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `timestamp`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `value`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `upperBound`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `lowerBound`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `isOutlier`</span></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/odpf/dagger/edit/master/docs/docs/reference/udfs.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dagger/docs/reference/transformers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Transformers</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dagger/docs/contribute/contribution"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contribution Process »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#list-of-udfs" class="table-of-contents__link">List of Udfs</a><ul><li><a href="#scalar-functions" class="table-of-contents__link">Scalar Functions</a></li><li><a href="#aggregate-functions" class="table-of-contents__link">Aggregate Functions</a></li><li><a href="#table-functions" class="table-of-contents__link">Table Functions</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/odpf/optimus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Optimus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/firehose" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Firehose<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/raccoon" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Raccoon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/stencil" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stencil<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dagger/docs/intro">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/dagger/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/dagger/help">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://bit.ly/2RzPbtn" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/odpf/dagger" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/dagger/assets/js/runtime~main.bebf1512.js"></script>
<script src="/dagger/assets/js/main.f47a97c9.js"></script>
</body>
</html>